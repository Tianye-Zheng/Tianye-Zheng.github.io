---
layout: post
title:  "计网笔记2-数据链路层"
date:   2020-07-22
desc: ""
keywords: ""
categories: [杂项]
tags: [计算机网络]
icon: icon-html
---
整理自B站王道考研视频

<br />
# 链路层的功能

`数据链路层` 负责通过一条链路从一个结点向另一个物理链路直接相连的相邻结点传送数据报（安全无差错地传给相邻结点）

最基本的服务是将源自网络层的数据**可靠**地传输到相邻节点的目标机网络层。主要作用是加强物理层传输原始比特流的功能，将物理层提供的可能出错的物理连接改造成为逻辑上无差错的数据链路，使之对网络层表现为一条无差错的链路。

**功能一** ： 为网络层提供服务。无确认无连接服务，有确认无连接服务，有确认面向连接服务。（**有连接一定有确认！**）

**功能二** ： 链路管理。即连接的建立、维持、释放（用于面向连接的服务）

**功能三** ： 组帧

**功能四** ： 流量控制

**功能五** ： 差错控制（帧错/位错）

<br />
## 数据链路层基本概念

`结点` ： 主机、路由器

`链路` ： 网络中两个结点之间的**物理通道**，链路的传输介质主要有双绞线、光纤和微波。分为有线链路、无线链路。

`数据链路` ： 网络中两个结点之间的**逻辑通道**，把实现控制数据传输协议的硬件和软件加到链路上就构成数据链路。

`帧` ： 链路层的协议数据单元，封装网络层数据报。

`封装成帧` 就是在一段数据的前后部分添加首部和尾部，这样就构成了一个帧。首部和尾部包含许多的控制信息，其重要作用之一是**帧定界**

`帧同步` ： 接收方应当能从接收到的二进制比特流中区分出帧的起始和终止。

<br />
## 封装成帧和透明传输

`透明传输` 指不管所传数据是什么样的比特组合，都应当能够在链路上传送。因此，链路层就 “看不见” 有什么妨碍数据传输的东西。（为保证透明，要考虑当所传数据中的比特组合恰巧与某一个控制信息完全一致时的情况）

组帧的四种方法：

1. `字符计数法`：帧首部使用一个计数字段（第一个字节，八位）来标明帧内字符数。（痛点：一错皆错）
2. `字符（节）填充法` ：帧首尾用特定的字节标识 SOH（start of header）与 EOT （end of transmission），这样当传送的是文本文件（即ASCII码时）可以实现透明传输，但如果传输的是二进制程序或图像时，则数据部分可能有错误边界，需要采用**字符填充方法**实现透明传输。做法是在数据部分里遇到控制字符时填充转义字符，接收端拿到后再把转义字符拿掉。
3. `零比特填充法`：首尾的标识符是一样的01111110。发送端扫描全部，只要连续5个1，就立即填入1个0. 接收端先找到标志字段确定边界，再扫描把连续5个1后面的0删除。
4. `违规编码法`：在**曼彻斯特编码**（用高-低电平来表示1，低-高电平来表示0）中，可以用高-高，低-低来定界帧的起始和终止。

由于字节计数法 count 字段的脆弱性和字符填充实现上的复杂和不兼容，目前比较普遍使用的帧同步法是**比特填充和违规编码法**

<br />
## 差错控制（检错编码）

差错由噪声而来

1. 由于线路本身电气特性所产生的随机噪声（热噪声），是信道固有的，随机存在的。解决办法：提高信号强度，提高信噪比。
2. 特定原因造成的短暂冲击噪声，是差错的主要原因。解决办法：利用编码技术来解决。

差错

1. 位错，1变0，0变1
2. 帧错，丢失，重复，失序

差错控制（比特错）

1. 检错编码：奇偶校验码、循环冗余码CRC
2. 纠错编码：海明码

`奇偶校验码` ： 由 n-1 位信息元和 1 位校验元构成。奇校验码：1 的个数为奇数；偶校验码： 1 的个数为偶数。特点：只能检查出**奇数个比特**错误，检错能力为50%

`CRC 循环冗余码` ： 要传的数据 / 生成多项式 得到余数称为 FCS帧检验序列(或冗余码)，最终发送的数据为要发送的数据加上FCS，...... 能够实现无比特差错的传输，但这还不是可靠传输

`海明码` ： 发现双比特错，纠正单比特错。工作原理：牵一发而动全身。

海明码工作流程：

1. 确定校验码位数r
2. 确定校验码和数据的位置：校验码放在2的几次方的位置
3. 求出校验码的值
4. 检错并纠错

$$海明不等式 : 2^{r}\geq k + r + 1 , r 为冗余信息位，k 为信息位$$

<br />
## 流量控制与可靠传输机制

**（关注可靠传输的原理，不要纠结是在哪一个层次的）**

数据链路层的流量控制：较高的发送速率和较低的接收能力不匹配，会造成传输出错（链路层的流量控制是点对点的，而传输层的流量控制是端到端的）

链路层流量控制手段：接收方收不下就不回复确认

传输层流量控制手段：接收端给发送端一个窗口公告

流量控制的方法：

1. 停止-等待协议：每发送完一个帧就停止发送，等待对方的确认，收到确认后再发送下一个帧（**传输效率低**）
2. 滑动窗口协议：

`后退N帧协议（GBN）` 采用**累积确认**的方式，表明接收方已经收到 n 号帧和它之前的全部帧。如果出现超时，发送方**重传所有已发送但未被确认的帧**。接受方如果收到**非所期待序号**的帧，会为最近按序接收的帧重新发送 ACK

<br />
<div align="center"><img src="https://raw.githubusercontent.com/Tianye-Zheng/Tianye-Zheng.github.io/master/PostPictures/2020-summer/3.png" width = "500" height =
"500" /></div>
<br />

选择重传协议（SR）

链路层的滑动窗口大小是**固定的**

1. 停止-等待协议：发送窗口大小=1，接收窗口大小=1
2. 后退 N 帧协议（GBN）：发送窗口大小 > 1，接收窗口大小=1
3. 选择重传协议（SR）：发送窗口大小 > 1，接收窗口大小 > 1

`信道利用率` ：发送方在一个发送周期内，有效地发送数据所需要的时间占整个发送周期的比率

`信道吞吐率 = 信道利用率×发送方的发送速率`




<br />
# 链路层的两种信道

<br />
# 局域网、广域网

<br />
# 链路层的设备

